#!/usr/bin/env node

var user = require('../models/user');
var ircSettings = require('../models/user/irc');
var argv = require('minimist')(process.argv.slice(2));

var login = argv._[0].trim();

delete argv._;

if (!Object.keys(argv).length) {
	console.error('No properties detected.');
	process.exit(1);
}

if (login) {
	user.getUserIDByEmail(login).then(function (userid) {
		if (!userid) {
			console.error('Login not found.');
			return process.exit(1);
		}

		return ircSettings.set(userid, argv).then(function () {
			console.log('IRC attributes for ' + login + ':' + userid + ' set to ', argv);
			process.exit(0);
		});
	}).then(function () {
		process.exit(0);
	});

} else {
	console.error('Missing login.');
	process.exit(1);
}
